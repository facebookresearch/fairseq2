<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../_static/img/logo.svg" rel="icon" type="image/svg+xml"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="fairseq2.model_checkpoint" href="fairseq2.model_checkpoint.html" /><link rel="prev" title="fairseq2.device" href="fairseq2.device.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>fairseq2.gang - fairseq2 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #008080;
  --color-brand-content: #008080;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">fairseq2 Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">fairseq2 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Latest News</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../news/whats_new_v0_5.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-report" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M1.75 1.5a.25.25 0 00-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 01.75.75v2.19l2.72-2.72a.75.75 0 01.53-.22h6.5a.25.25 0 00.25-.25v-9.5a.25.25 0 00-.25-.25H1.75zM0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0114.25 13H8.06l-2.573 2.573A1.457 1.457 0 013 14.543V13H1.75A1.75 1.75 0 010 11.25v-9.5zM9 9a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z" fill-rule="evenodd"></path></svg> What’s New in v0.5</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/installation/index.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-download" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z" fill-rule="evenodd"></path></svg> Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of  Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation/installation_from_source.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-file-binary" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0114.25 15h-9a.75.75 0 010-1.5h9a.25.25 0 00.25-.25V6h-2.75A1.75 1.75 0 0110 4.25V1.5H5.75a.25.25 0 00-.25.25v2a.75.75 0 01-1.5 0v-2zm7.5-.188V4.25c0 .138.112.25.25.25h2.688a.252.252 0 00-.011-.013l-2.914-2.914a.272.272 0 00-.013-.011zM0 7.75C0 6.784.784 6 1.75 6h1.5C4.216 6 5 6.784 5 7.75v2.5A1.75 1.75 0 013.25 12h-1.5A1.75 1.75 0 010 10.25v-2.5zm1.75-.25a.25.25 0 00-.25.25v2.5c0 .138.112.25.25.25h1.5a.25.25 0 00.25-.25v-2.5a.25.25 0 00-.25-.25h-1.5zm5-1.5a.75.75 0 000 1.5h.75v3h-.75a.75.75 0 000 1.5h3a.75.75 0 000-1.5H9V6.75A.75.75 0 008.25 6h-1.5z" fill-rule="evenodd"></path></svg> Installing from Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation/setup_with_uv.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-lock" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4 4v2h-.25A1.75 1.75 0 002 7.75v5.5c0 .966.784 1.75 1.75 1.75h8.5A1.75 1.75 0 0014 13.25v-5.5A1.75 1.75 0 0012.25 6H12V4a4 4 0 10-8 0zm6.5 2V4a2.5 2.5 0 00-5 0v2h5zM12 7.5h.25a.25.25 0 01.25.25v5.5a.25.25 0 01-.25.25h-8.5a.25.25 0 01-.25-.25v-5.5a.25.25 0 01.25-.25H12z" fill-rule="evenodd"></path></svg> UV Setup</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basics/design_philosophy.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-infinity" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M3.5 6c-1.086 0-2 .914-2 2 0 1.086.914 2 2 2 .525 0 1.122-.244 1.825-.727.51-.35 1.025-.79 1.561-1.273-.536-.483-1.052-.922-1.56-1.273C4.621 6.244 4.025 6 3.5 6zm4.5.984c-.59-.533-1.204-1.066-1.825-1.493-.797-.548-1.7-.991-2.675-.991C1.586 4.5 0 6.086 0 8s1.586 3.5 3.5 3.5c.975 0 1.878-.444 2.675-.991.621-.427 1.235-.96 1.825-1.493.59.533 1.204 1.066 1.825 1.493.797.547 1.7.991 2.675.991 1.914 0 3.5-1.586 3.5-3.5s-1.586-3.5-3.5-3.5c-.975 0-1.878.443-2.675.991-.621.427-1.235.96-1.825 1.493zM9.114 8c.536.483 1.052.922 1.56 1.273.704.483 1.3.727 1.826.727 1.086 0 2-.914 2-2 0-1.086-.914-2-2-2-.525 0-1.122.244-1.825.727-.51.35-1.025.79-1.561 1.273z" fill-rule="evenodd"></path></svg> Design Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/assets.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-container" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M10.41.24l4.711 2.774A1.767 1.767 0 0116 4.54v5.01a1.77 1.77 0 01-.88 1.53l-7.753 4.521-.002.001a1.767 1.767 0 01-1.774 0H5.59L.873 12.85A1.762 1.762 0 010 11.327V6.292c0-.304.078-.598.22-.855l.004-.005.01-.019c.15-.262.369-.486.64-.643L8.641.239a1.75 1.75 0 011.765 0l.002.001zM9.397 1.534a.25.25 0 01.252 0l4.115 2.422-7.152 4.148a.267.267 0 01-.269 0L2.227 5.716l7.17-4.182zM7.365 9.402L8.73 8.61v4.46l-1.5.875V9.473a1.77 1.77 0 00.136-.071zm2.864 2.794V7.741l1.521-.882v4.45l-1.521.887zm3.021-1.762l1.115-.65h.002a.268.268 0 00.133-.232V5.264l-1.25.725v4.445zm-11.621 1.12l4.1 2.393V9.474a1.77 1.77 0 01-.138-.072L1.5 7.029v4.298c0 .095.05.181.129.227z" fill-rule="evenodd"></path></svg> Assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/building_recipes.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-rocket" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M14.064 0a8.75 8.75 0 00-6.187 2.563l-.459.458c-.314.314-.616.641-.904.979H3.31a1.75 1.75 0 00-1.49.833L.11 7.607a.75.75 0 00.418 1.11l3.102.954c.037.051.079.1.124.145l2.429 2.428c.046.046.094.088.145.125l.954 3.102a.75.75 0 001.11.418l2.774-1.707a1.75 1.75 0 00.833-1.49V9.485c.338-.288.665-.59.979-.904l.458-.459A8.75 8.75 0 0016 1.936V1.75A1.75 1.75 0 0014.25 0h-.186zM10.5 10.625c-.088.06-.177.118-.266.175l-2.35 1.521.548 1.783 1.949-1.2a.25.25 0 00.119-.213v-2.066zM3.678 8.116L5.2 5.766c.058-.09.117-.178.176-.266H3.309a.25.25 0 00-.213.119l-1.2 1.95 1.782.547zm5.26-4.493A7.25 7.25 0 0114.063 1.5h.186a.25.25 0 01.25.25v.186a7.25 7.25 0 01-2.123 5.127l-.459.458a15.21 15.21 0 01-2.499 2.02l-2.317 1.5-2.143-2.143 1.5-2.317a15.25 15.25 0 012.02-2.5l.458-.458h.002zM12 5a1 1 0 11-2 0 1 1 0 012 0zm-8.44 9.56a1.5 1.5 0 10-2.12-2.12c-.734.73-1.047 2.332-1.15 3.003a.23.23 0 00.265.265c.671-.103 2.273-.416 3.005-1.148z" fill-rule="evenodd"></path></svg> Building Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/runtime_extension.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-plug" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M10.276 3.09a.25.25 0 01.192-.09h.782a.25.25 0 01.25.25v8.5a.25.25 0 01-.25.25h-.782a.25.25 0 01-.192-.09l-.95-1.14a.75.75 0 00-.483-.264l-3.124-.39a.25.25 0 01-.219-.249V5.133a.25.25 0 01.219-.248l3.124-.39a.75.75 0 00.483-.265l.95-1.14zM4 8v1.867a1.75 1.75 0 001.533 1.737l2.83.354.761.912c.332.4.825.63 1.344.63h.782A1.75 1.75 0 0013 11.75V11h2.25a.75.75 0 000-1.5H13v-4h2.25a.75.75 0 000-1.5H13v-.75a1.75 1.75 0 00-1.75-1.75h-.782c-.519 0-1.012.23-1.344.63l-.76.913-2.831.353A1.75 1.75 0 004 5.133V6.5H2.5A2.5 2.5 0 000 9v5.25a.75.75 0 001.5 0V9a1 1 0 011-1H4z" fill-rule="evenodd"></path></svg> Runtime Extension</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/add_model.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-ruby" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M3.637 2.291A.75.75 0 014.23 2h7.54a.75.75 0 01.593.291l3.48 4.5a.75.75 0 01-.072.999l-7.25 7a.75.75 0 01-1.042 0l-7.25-7a.75.75 0 01-.072-.999l3.48-4.5zM4.598 3.5L1.754 7.177 8 13.207l6.246-6.03L11.402 3.5H4.598z" fill-rule="evenodd"></path></svg> Add Your Own Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/pudb.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-bug" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4.72.22a.75.75 0 011.06 0l1 .999a3.492 3.492 0 012.441 0l.999-1a.75.75 0 111.06 1.061l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 01.556 1.392L13 7.258V9h2.25a.75.75 0 010 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 01-.557 1.392l-2.184-.873A4.997 4.997 0 018 16a4.997 4.997 0 01-4.288-2.427l-2.183.873a.75.75 0 01-.558-1.392l2.17-.868A5.013 5.013 0 013 11v-.5H.75a.75.75 0 010-1.5H3V7.258L.971 6.446a.75.75 0 01.558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.684 1.684 0 01-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 010-1.06zM6.173 5h3.654A.173.173 0 0010 4.827V4.5a2 2 0 10-4 0v.327c0 .096.077.173.173.173zM5.25 6.5a.75.75 0 00-.75.75V11a3.5 3.5 0 107 0V7.25a.75.75 0 00-.75-.75h-5.5z" fill-rule="evenodd"></path></svg> Debugging with PuDB</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/gang.html">Gangs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="assets.html">fairseq2.assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="checkpoint.html">fairseq2.checkpoint</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="data/index.html">fairseq2.data</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of fairseq2.data</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="data/tokenizers/index.html">fairseq2.data.tokenizers</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of fairseq2.data.tokenizers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="data/tokenizers/hub.html">fairseq2.data.tokenizers.hub</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="datasets/index.html">fairseq2.datasets</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of fairseq2.datasets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="datasets/hub.html">fairseq2.datasets.hub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fairseq2.device.html">fairseq2.device</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">fairseq2.gang</a></li>
<li class="toctree-l1"><a class="reference internal" href="fairseq2.model_checkpoint.html">fairseq2.model_checkpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="fairseq2.models.html">fairseq2.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="fairseq2.recipe.optim.html">fairseq2.recipe.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="fairseq2.utils.validation.html">fairseq2.utils.validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">fairseq2.logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">fairseq2.metrics</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="models/index.html">fairseq2.models</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of fairseq2.models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="models/hub.html">fairseq2.models.hub</a></li>
<li class="toctree-l2"><a class="reference internal" href="models/qwen.html">fairseq2.models.qwen</a></li>
<li class="toctree-l2"><a class="reference internal" href="models/llama.html">fairseq2.models.llama</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="nn/index.html">fairseq2.nn</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of fairseq2.nn</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="nn/batch_layout.html">Batch Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn/embedding.html">Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn/position_encoder.html">Position Encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn/normalization.html">Normalization Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn/projection.html">Projection Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn/residual.html">Residual Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn/incremental_state.html">Incremental State</a></li>
<li class="toctree-l2"><a class="reference internal" href="nn/utils.html">fairseq2.nn.utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">fairseq2.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipe.html">fairseq2.recipe</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../other/contributing.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-heart" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.75.75 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5zM8 14.25l-.345.666-.002-.001-.006-.003-.018-.01a7.643 7.643 0 01-.31-.17 22.075 22.075 0 01-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.08 22.08 0 01-3.744 2.584l-.018.01-.006.003h-.002L8 14.25zm0 0l.345.666a.752.752 0 01-.69 0L8 14.25z" fill-rule="evenodd"></path></svg> Contributing to fairseq2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/bibliography.html"><svg aria-hidden="true" class="sd-octicon sd-octicon-book" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M0 1.75A.75.75 0 01.75 1h4.253c1.227 0 2.317.59 3 1.501A3.744 3.744 0 0111.006 1h4.245a.75.75 0 01.75.75v10.5a.75.75 0 01-.75.75h-4.507a2.25 2.25 0 00-1.591.659l-.622.621a.75.75 0 01-1.06 0l-.622-.621A2.25 2.25 0 005.258 13H.75a.75.75 0 01-.75-.75V1.75zm8.755 3a2.25 2.25 0 012.25-2.25H14.5v9h-3.757c-.71 0-1.4.201-1.992.572l.004-7.322zm-1.504 7.324l.004-5.073-.002-2.253A2.25 2.25 0 005.003 2.5H1.5v9h3.757a3.75 3.75 0 011.994.574z" fill-rule="evenodd"></path></svg> Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/reference/fairseq2.gang.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-fairseq2.gang">
<span id="fairseq2-gang"></span><h1>fairseq2.gang<a class="headerlink" href="#module-fairseq2.gang" title="Link to this heading">¶</a></h1>
<p>A <a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gang</span></code></a> represents a set of processes that can perform collective
operations such as all-reduce, broadcast, and other distributed primitives.</p>
<p>This module provides <a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gang</span></code></a> implementations that supports both real
distributed environments (using PyTorch’s distributed backend) and simulated
environments for testing and single-process scenarios.</p>
<p>See <a class="reference internal" href="../concepts/gang.html"><span class="doc">What is a Gang?</span></a> for more information.</p>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fairseq2.gang.Gang">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">Gang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Closable</span></code></p>
<p>Represents a set of processes that work collectively.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.create_gang">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_gang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.14)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.create_gang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.create_gang" title="Link to this definition">¶</a></dt>
<dd><p>Creates a new sub-gang with the specified process ranks.</p>
<p>The ranks must be unique and within the range [0, gang.size).</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the current process is not included in <code class="docutils literal notranslate"><span class="pre">ranks</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">ranks</span></code> contains duplicates, or has one or more
out of range values.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Creating a sub-gang with specific processes</span><a class="headerlink" href="#id3" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a gang with ranks 0, 2, 4 from an 8-process gang</span>
<span class="n">sub_gang</span> <span class="o">=</span> <span class="n">root_gang</span><span class="o">.</span><span class="n">create_gang</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="k">if</span> <span class="n">sub_gang</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Current process is part of the new gang</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New gang rank: </span><span class="si">{</span><span class="n">sub_gang</span><span class="o">.</span><span class="n">rank</span><span class="si">}</span><span class="s2">, size: </span><span class="si">{</span><span class="n">sub_gang</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.as_process_group">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">as_process_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ProcessGroup</span></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.as_process_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.as_process_group" title="Link to this definition">¶</a></dt>
<dd><p>Returns this gang as a PyTorch ProcessGroup that can be used with
PyTorch’s distributed operations and collective communication functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotSupportedError</strong> – If the gang implementation does not support
conversion to a ProcessGroup (e.g. <a class="reference internal" href="#fairseq2.gang.FakeGang" title="fairseq2.gang.FakeGang"><code class="xref py py-class docutils literal notranslate"><span class="pre">FakeGang</span></code></a>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.barrier">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">barrier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.barrier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.barrier" title="Link to this definition">¶</a></dt>
<dd><p>Synchronizes all processes in the gang.</p>
<p>This is a collective operation that blocks until all processes in the
gang reach this synchronization point. Used for ensuring a consistent
state across all processes before proceeding.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.all_reduce">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.ReduceOperation" title="fairseq2.gang.ReduceOperation"><span class="pre">ReduceOperation</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.all_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.all_reduce" title="Link to this definition">¶</a></dt>
<dd><p>Reduces <code class="docutils literal notranslate"><span class="pre">tensor</span></code> across all processes using the specified operation.</p>
<p>All-reduce combines tensors from all processes using the specified
operation and distributes the result to all processes. The input tensor
is modified in-place to contain the reduction result.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Computing sum across all processes</span><a class="headerlink" href="#id4" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fairseq2.gang</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReduceOperation</span>

<span class="c1"># Each process has a different tensor</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Sum across all processes</span>
<span class="n">gang</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">ReduceOperation</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>

<span class="c1"># Now tensor contains the sum of all ranks</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of all ranks: </span><span class="si">{</span><span class="n">tensor</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.all_gather">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.all_gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.all_gather" title="Link to this definition">¶</a></dt>
<dd><p>Gathers tensors from all processes and puts them in <code class="docutils literal notranslate"><span class="pre">output_tensor</span></code>.</p>
<p>All-gather collects input tensors from all processes, concatenates them
along a new first dimension in rank order and writes to the output
tensor. The output tensor must have shape <code class="docutils literal notranslate"><span class="pre">[gang.size,</span> <span class="pre">*input_tensor.shape]</span></code>
and be contiguous in memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Gathering tensors from all processes</span><a class="headerlink" href="#id5" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Each process contributes a tensor with its rank</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span> <span class="o">*</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Prepare output tensor for all gathered tensors</span>
<span class="n">output_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Gather from all processes</span>
<span class="n">gang</span><span class="o">.</span><span class="n">all_gather</span><span class="p">(</span><span class="n">output_tensor</span><span class="p">,</span> <span class="n">input_tensor</span><span class="p">)</span>

<span class="c1"># output_tensor now contains [0, 10, 20, ...] for ranks 0,1,2,...</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.all_gather_to_list">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_gather_to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.all_gather_to_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.all_gather_to_list" title="Link to this definition">¶</a></dt>
<dd><p>Gathers tensors from all processes and puts them in <code class="docutils literal notranslate"><span class="pre">output_tensors</span></code>.</p>
<p>Similar to <a class="reference internal" href="#fairseq2.gang.Gang.all_gather" title="fairseq2.gang.Gang.all_gather"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_gather()</span></code></a>, but stores the gathered tensors in a list
instead of concatenating them into a single tensor. <code class="docutils literal notranslate"><span class="pre">output_tensors</span></code>
must be a pre-allocated list with length equal to <code class="docutils literal notranslate"><span class="pre">gang.size</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.broadcast">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">broadcast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.broadcast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.broadcast" title="Link to this definition">¶</a></dt>
<dd><p>Broadcasts <code class="docutils literal notranslate"><span class="pre">tensor</span></code> from the specified rank to all processes.</p>
<p>Broadcast copies the tensor from the source process to all other
processes. The tensor is modified in-place on non-source processes to
contain the broadcasted data.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_rank</span></code> must be in range [0, gang.size).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">source_rank</span></code> is out of valid range.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.broadcast_objects">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">broadcast_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><span class="pre">object</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gang.broadcast_objects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gang.broadcast_objects" title="Link to this definition">¶</a></dt>
<dd><p>Broadcasts picklable <code class="docutils literal notranslate"><span class="pre">objects</span></code> from the specified rank to all processes.</p>
<p>Similar to <a class="reference internal" href="#fairseq2.gang.Gang.broadcast" title="fairseq2.gang.Gang.broadcast"><code class="xref py py-meth docutils literal notranslate"><span class="pre">broadcast()</span></code></a>, but copies arbitrary Python objects that
can be pickled. The objects are modified in-place on non-source processes.
Each process must provide lists of equal sizes.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_rank</span></code> must be in range [0, gang.size).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">source_rank</span></code> is out of valid range.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.rank">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rank</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#fairseq2.gang.Gang.rank" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.size">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#fairseq2.gang.Gang.size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.device">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a></em><a class="headerlink" href="#fairseq2.gang.Gang.device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.Gang.supports_process_group">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_process_group</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#fairseq2.gang.Gang.supports_process_group" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang">
<em class="property"><span class="pre">final</span><span class="w"> </span><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">ProcessGroupGang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_pg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ProcessGroup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gang</span></code></a></p>
<p>Represents a gang that wraps a PyTorch ProcessGroup.</p>
<p>This is a distributed gang implementation that uses PyTorch’s distributed
backend for actual inter-process communication.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.create_default_process_group">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_default_process_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.14)"><span class="pre">timedelta</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_priority</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang" title="fairseq2.gang.ProcessGroupGang"><span class="pre">ProcessGroupGang</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.create_default_process_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.create_default_process_group" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the default process group and wraps it as a gang.</p>
<p>For CUDA devices, NCCL; for CPU devices, Gloo backend will be used.</p>
<p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> specifies the timeout for collective operations. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
the default timeout (15 minutes) will be used.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">high_priority</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the underlying collective operations
will be performed on high-priority channels (e.g. CUDA streams) if
supported by the underlying backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">device</span></code> is not of type <code class="docutils literal notranslate"><span class="pre">cpu</span></code> or <code class="docutils literal notranslate"><span class="pre">cuda</span></code>.</p></li>
<li><p><strong>NotSupportedError</strong> – If <code class="docutils literal notranslate"><span class="pre">torch.distributed</span></code> is not available.</p></li>
<li><p><strong>InvalidOperationError</strong> – If the root process group is already
initialized.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the underlying process group fails to initialize
due to an unexpected error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.close" title="Link to this definition">¶</a></dt>
<dd><p>Destroys the underlying ProcessGroup.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.create_gang">
<span class="sig-name descname"><span class="pre">create_gang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.14)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang" title="fairseq2.gang.ProcessGroupGang"><span class="pre">ProcessGroupGang</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.create_gang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.create_gang" title="Link to this definition">¶</a></dt>
<dd><p>Creates a new sub-gang with the specified process ranks.</p>
<p>The ranks must be unique and within the range [0, gang.size).</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the current process is not included in <code class="docutils literal notranslate"><span class="pre">ranks</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">ranks</span></code> contains duplicates, or has one or more
out of range values.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Creating a sub-gang with specific processes</span><a class="headerlink" href="#id6" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a gang with ranks 0, 2, 4 from an 8-process gang</span>
<span class="n">sub_gang</span> <span class="o">=</span> <span class="n">root_gang</span><span class="o">.</span><span class="n">create_gang</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="k">if</span> <span class="n">sub_gang</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Current process is part of the new gang</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New gang rank: </span><span class="si">{</span><span class="n">sub_gang</span><span class="o">.</span><span class="n">rank</span><span class="si">}</span><span class="s2">, size: </span><span class="si">{</span><span class="n">sub_gang</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.as_process_group">
<span class="sig-name descname"><span class="pre">as_process_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ProcessGroup</span></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.as_process_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.as_process_group" title="Link to this definition">¶</a></dt>
<dd><p>Returns this gang as a PyTorch ProcessGroup that can be used with
PyTorch’s distributed operations and collective communication functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotSupportedError</strong> – If the gang implementation does not support
conversion to a ProcessGroup (e.g. <a class="reference internal" href="#fairseq2.gang.FakeGang" title="fairseq2.gang.FakeGang"><code class="xref py py-class docutils literal notranslate"><span class="pre">FakeGang</span></code></a>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.barrier">
<span class="sig-name descname"><span class="pre">barrier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.barrier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.barrier" title="Link to this definition">¶</a></dt>
<dd><p>Synchronizes all processes in the gang.</p>
<p>This is a collective operation that blocks until all processes in the
gang reach this synchronization point. Used for ensuring a consistent
state across all processes before proceeding.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.all_reduce">
<span class="sig-name descname"><span class="pre">all_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.ReduceOperation" title="fairseq2.gang.ReduceOperation"><span class="pre">ReduceOperation</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.all_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.all_reduce" title="Link to this definition">¶</a></dt>
<dd><p>Reduces <code class="docutils literal notranslate"><span class="pre">tensor</span></code> across all processes using the specified operation.</p>
<p>All-reduce combines tensors from all processes using the specified
operation and distributes the result to all processes. The input tensor
is modified in-place to contain the reduction result.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Computing sum across all processes</span><a class="headerlink" href="#id7" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fairseq2.gang</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReduceOperation</span>

<span class="c1"># Each process has a different tensor</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Sum across all processes</span>
<span class="n">gang</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">ReduceOperation</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>

<span class="c1"># Now tensor contains the sum of all ranks</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of all ranks: </span><span class="si">{</span><span class="n">tensor</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.all_gather">
<span class="sig-name descname"><span class="pre">all_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.all_gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.all_gather" title="Link to this definition">¶</a></dt>
<dd><p>Gathers tensors from all processes and puts them in <code class="docutils literal notranslate"><span class="pre">output_tensor</span></code>.</p>
<p>All-gather collects input tensors from all processes, concatenates them
along a new first dimension in rank order and writes to the output
tensor. The output tensor must have shape <code class="docutils literal notranslate"><span class="pre">[gang.size,</span> <span class="pre">*input_tensor.shape]</span></code>
and be contiguous in memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Gathering tensors from all processes</span><a class="headerlink" href="#id8" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Each process contributes a tensor with its rank</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span> <span class="o">*</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Prepare output tensor for all gathered tensors</span>
<span class="n">output_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Gather from all processes</span>
<span class="n">gang</span><span class="o">.</span><span class="n">all_gather</span><span class="p">(</span><span class="n">output_tensor</span><span class="p">,</span> <span class="n">input_tensor</span><span class="p">)</span>

<span class="c1"># output_tensor now contains [0, 10, 20, ...] for ranks 0,1,2,...</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.all_gather_to_list">
<span class="sig-name descname"><span class="pre">all_gather_to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.all_gather_to_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.all_gather_to_list" title="Link to this definition">¶</a></dt>
<dd><p>Gathers tensors from all processes and puts them in <code class="docutils literal notranslate"><span class="pre">output_tensors</span></code>.</p>
<p>Similar to <a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.all_gather" title="fairseq2.gang.ProcessGroupGang.all_gather"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_gather()</span></code></a>, but stores the gathered tensors in a list
instead of concatenating them into a single tensor. <code class="docutils literal notranslate"><span class="pre">output_tensors</span></code>
must be a pre-allocated list with length equal to <code class="docutils literal notranslate"><span class="pre">gang.size</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.broadcast">
<span class="sig-name descname"><span class="pre">broadcast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.broadcast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.broadcast" title="Link to this definition">¶</a></dt>
<dd><p>Broadcasts <code class="docutils literal notranslate"><span class="pre">tensor</span></code> from the specified rank to all processes.</p>
<p>Broadcast copies the tensor from the source process to all other
processes. The tensor is modified in-place on non-source processes to
contain the broadcasted data.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_rank</span></code> must be in range [0, gang.size).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">source_rank</span></code> is out of valid range.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.broadcast_objects">
<span class="sig-name descname"><span class="pre">broadcast_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><span class="pre">object</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#ProcessGroupGang.broadcast_objects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.broadcast_objects" title="Link to this definition">¶</a></dt>
<dd><p>Broadcasts picklable <code class="docutils literal notranslate"><span class="pre">objects</span></code> from the specified rank to all processes.</p>
<p>Similar to <a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.broadcast" title="fairseq2.gang.ProcessGroupGang.broadcast"><code class="xref py py-meth docutils literal notranslate"><span class="pre">broadcast()</span></code></a>, but copies arbitrary Python objects that
can be pickled. The objects are modified in-place on non-source processes.
Each process must provide lists of equal sizes.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_rank</span></code> must be in range [0, gang.size).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">source_rank</span></code> is out of valid range.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.rank">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rank</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.rank" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a></em><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.ProcessGroupGang.supports_process_group">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_process_group</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#fairseq2.gang.ProcessGroupGang.supports_process_group" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang">
<em class="property"><span class="pre">final</span><span class="w"> </span><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">FakeGang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gang</span></code></a></p>
<p>Represents a non-distributed gang for local use.</p>
<p>This implementation simulates gang operations without actual distributed
communication, making it useful for testing, debugging, and single-process
execution. All collective operations are no-ops.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Simulating a collective operation</span><a class="headerlink" href="#id9" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">fairseq2.gang</span><span class="w"> </span><span class="kn">import</span> <span class="n">FakeGang</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="n">gang</span> <span class="o">=</span> <span class="n">FakeGang</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Simulates as if a real all-reduce operation is performed on the gang.</span>
<span class="n">gang</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">ReduceOperation</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.close" title="Link to this definition">¶</a></dt>
<dd><p>No-op</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.create_gang">
<span class="sig-name descname"><span class="pre">create_gang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.14)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.FakeGang" title="fairseq2.gang.FakeGang"><span class="pre">FakeGang</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.create_gang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.create_gang" title="Link to this definition">¶</a></dt>
<dd><p>Creates a new sub-gang with the specified process ranks.</p>
<p>The ranks must be unique and within the range [0, gang.size).</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the current process is not included in <code class="docutils literal notranslate"><span class="pre">ranks</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">ranks</span></code> contains duplicates, or has one or more
out of range values.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Creating a sub-gang with specific processes</span><a class="headerlink" href="#id10" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a gang with ranks 0, 2, 4 from an 8-process gang</span>
<span class="n">sub_gang</span> <span class="o">=</span> <span class="n">root_gang</span><span class="o">.</span><span class="n">create_gang</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="k">if</span> <span class="n">sub_gang</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Current process is part of the new gang</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New gang rank: </span><span class="si">{</span><span class="n">sub_gang</span><span class="o">.</span><span class="n">rank</span><span class="si">}</span><span class="s2">, size: </span><span class="si">{</span><span class="n">sub_gang</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.as_process_group">
<span class="sig-name descname"><span class="pre">as_process_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ProcessGroup</span></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.as_process_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.as_process_group" title="Link to this definition">¶</a></dt>
<dd><p>Returns this gang as a PyTorch ProcessGroup that can be used with
PyTorch’s distributed operations and collective communication functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotSupportedError</strong> – If the gang implementation does not support
conversion to a ProcessGroup (e.g. <a class="reference internal" href="#fairseq2.gang.FakeGang" title="fairseq2.gang.FakeGang"><code class="xref py py-class docutils literal notranslate"><span class="pre">FakeGang</span></code></a>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.barrier">
<span class="sig-name descname"><span class="pre">barrier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.barrier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.barrier" title="Link to this definition">¶</a></dt>
<dd><p>Synchronizes all processes in the gang.</p>
<p>This is a collective operation that blocks until all processes in the
gang reach this synchronization point. Used for ensuring a consistent
state across all processes before proceeding.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.all_reduce">
<span class="sig-name descname"><span class="pre">all_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.ReduceOperation" title="fairseq2.gang.ReduceOperation"><span class="pre">ReduceOperation</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.all_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.all_reduce" title="Link to this definition">¶</a></dt>
<dd><p>Reduces <code class="docutils literal notranslate"><span class="pre">tensor</span></code> across all processes using the specified operation.</p>
<p>All-reduce combines tensors from all processes using the specified
operation and distributes the result to all processes. The input tensor
is modified in-place to contain the reduction result.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Computing sum across all processes</span><a class="headerlink" href="#id11" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fairseq2.gang</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReduceOperation</span>

<span class="c1"># Each process has a different tensor</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Sum across all processes</span>
<span class="n">gang</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">ReduceOperation</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>

<span class="c1"># Now tensor contains the sum of all ranks</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of all ranks: </span><span class="si">{</span><span class="n">tensor</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.all_gather">
<span class="sig-name descname"><span class="pre">all_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.all_gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.all_gather" title="Link to this definition">¶</a></dt>
<dd><p>Gathers tensors from all processes and puts them in <code class="docutils literal notranslate"><span class="pre">output_tensor</span></code>.</p>
<p>All-gather collects input tensors from all processes, concatenates them
along a new first dimension in rank order and writes to the output
tensor. The output tensor must have shape <code class="docutils literal notranslate"><span class="pre">[gang.size,</span> <span class="pre">*input_tensor.shape]</span></code>
and be contiguous in memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">Gathering tensors from all processes</span><a class="headerlink" href="#id12" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Each process contributes a tensor with its rank</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span> <span class="o">*</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Prepare output tensor for all gathered tensors</span>
<span class="n">output_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Gather from all processes</span>
<span class="n">gang</span><span class="o">.</span><span class="n">all_gather</span><span class="p">(</span><span class="n">output_tensor</span><span class="p">,</span> <span class="n">input_tensor</span><span class="p">)</span>

<span class="c1"># output_tensor now contains [0, 10, 20, ...] for ranks 0,1,2,...</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.all_gather_to_list">
<span class="sig-name descname"><span class="pre">all_gather_to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_tensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.all_gather_to_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.all_gather_to_list" title="Link to this definition">¶</a></dt>
<dd><p>Gathers tensors from all processes and puts them in <code class="docutils literal notranslate"><span class="pre">output_tensors</span></code>.</p>
<p>Similar to <a class="reference internal" href="#fairseq2.gang.FakeGang.all_gather" title="fairseq2.gang.FakeGang.all_gather"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_gather()</span></code></a>, but stores the gathered tensors in a list
instead of concatenating them into a single tensor. <code class="docutils literal notranslate"><span class="pre">output_tensors</span></code>
must be a pre-allocated list with length equal to <code class="docutils literal notranslate"><span class="pre">gang.size</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.broadcast">
<span class="sig-name descname"><span class="pre">broadcast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.broadcast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.broadcast" title="Link to this definition">¶</a></dt>
<dd><p>Broadcasts <code class="docutils literal notranslate"><span class="pre">tensor</span></code> from the specified rank to all processes.</p>
<p>Broadcast copies the tensor from the source process to all other
processes. The tensor is modified in-place on non-source processes to
contain the broadcasted data.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_rank</span></code> must be in range [0, gang.size).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">source_rank</span></code> is out of valid range.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.broadcast_objects">
<span class="sig-name descname"><span class="pre">broadcast_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><span class="pre">object</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#FakeGang.broadcast_objects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.FakeGang.broadcast_objects" title="Link to this definition">¶</a></dt>
<dd><p>Broadcasts picklable <code class="docutils literal notranslate"><span class="pre">objects</span></code> from the specified rank to all processes.</p>
<p>Similar to <a class="reference internal" href="#fairseq2.gang.FakeGang.broadcast" title="fairseq2.gang.FakeGang.broadcast"><code class="xref py py-meth docutils literal notranslate"><span class="pre">broadcast()</span></code></a>, but copies arbitrary Python objects that
can be pickled. The objects are modified in-place on non-source processes.
Each process must provide lists of equal sizes.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_rank</span></code> must be in range [0, gang.size).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">source_rank</span></code> is out of valid range.</p></li>
<li><p><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><strong>GangError</strong></a> – If the collective operation fails due to an unexpected
error such as a network communication failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.rank">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rank</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#fairseq2.gang.FakeGang.rank" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#fairseq2.gang.FakeGang.size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a></em><a class="headerlink" href="#fairseq2.gang.FakeGang.device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fairseq2.gang.FakeGang.supports_process_group">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_process_group</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#fairseq2.gang.FakeGang.supports_process_group" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">Gangs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gangs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gangs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Closable</span></code></p>
<p>Holds parallel gangs used in distributed configurations.</p>
<p>Each gang is used for a different parallelism strategy such as data, tensor,
or pipeline parallelism.</p>
<p>Check out <a class="reference internal" href="#fairseq2.gang.create_parallel_gangs" title="fairseq2.gang.create_parallel_gangs"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_parallel_gangs()</span></code></a> and <a class="reference internal" href="#fairseq2.gang.create_fsdp_gangs" title="fairseq2.gang.create_fsdp_gangs"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_fsdp_gangs()</span></code></a> to see
how to initialize a <code class="docutils literal notranslate"><span class="pre">Gangs</span></code> instance.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs.root">
<span class="sig-name descname"><span class="pre">root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></em><a class="headerlink" href="#fairseq2.gang.Gangs.root" title="Link to this definition">¶</a></dt>
<dd><p>The root gang containing all processes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs.dp">
<span class="sig-name descname"><span class="pre">dp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></em><a class="headerlink" href="#fairseq2.gang.Gangs.dp" title="Link to this definition">¶</a></dt>
<dd><p>The data parallel gang.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs.rdp">
<span class="sig-name descname"><span class="pre">rdp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></em><a class="headerlink" href="#fairseq2.gang.Gangs.rdp" title="Link to this definition">¶</a></dt>
<dd><p>The replicated data parallel gang (i.e. inter-node for HSDP).</p>
<p>This is a sub-gang of <a class="reference internal" href="#fairseq2.gang.Gangs.dp" title="fairseq2.gang.Gangs.dp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dp</span></code></a> used for replicated data parallelism. In
PyTorch, this gang is used by DDP as well as by FSDP for inter-node
communication when hybrid sharding is enabled.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs.sdp">
<span class="sig-name descname"><span class="pre">sdp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></em><a class="headerlink" href="#fairseq2.gang.Gangs.sdp" title="Link to this definition">¶</a></dt>
<dd><p>The sharded data parallel gang (i.e. intra-node for HSDP).</p>
<p>This is a sub-gang of <a class="reference internal" href="#fairseq2.gang.Gangs.dp" title="fairseq2.gang.Gangs.dp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dp</span></code></a> used for sharded data parallelism. In
PyTorch, this gang is used by FSDP. If hybrid sharding is enabled, it will
be used only for intra-node communication, while inter-node communication
will be handled by <a class="reference internal" href="#fairseq2.gang.Gangs.rdp" title="fairseq2.gang.Gangs.rdp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rdp</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs.tp">
<span class="sig-name descname"><span class="pre">tp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></em><a class="headerlink" href="#fairseq2.gang.Gangs.tp" title="Link to this definition">¶</a></dt>
<dd><p>The tensor parallel gang.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs.pp">
<span class="sig-name descname"><span class="pre">pp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></em><a class="headerlink" href="#fairseq2.gang.Gangs.pp" title="Link to this definition">¶</a></dt>
<dd><p>The pipeline parallel gang.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fairseq2.gang.Gangs.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#Gangs.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.Gangs.close" title="Link to this definition">¶</a></dt>
<dd><p>Destroys all gangs.</p>
</dd></dl>

</dd></dl>

</section>
<section id="enums">
<h2>Enums<a class="headerlink" href="#enums" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fairseq2.gang.ReduceOperation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">ReduceOperation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fairseq2/gang.html#ReduceOperation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.ReduceOperation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Defines the standard reduction operations that can be performed across
processes during collective communication operations like all-reduce.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.ReduceOperation.SUM">
<span class="sig-name descname"><span class="pre">SUM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#fairseq2.gang.ReduceOperation.SUM" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.ReduceOperation.MEAN">
<span class="sig-name descname"><span class="pre">MEAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#fairseq2.gang.ReduceOperation.MEAN" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.ReduceOperation.PRODUCT">
<span class="sig-name descname"><span class="pre">PRODUCT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#fairseq2.gang.ReduceOperation.PRODUCT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.ReduceOperation.MIN">
<span class="sig-name descname"><span class="pre">MIN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#fairseq2.gang.ReduceOperation.MIN" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fairseq2.gang.ReduceOperation.MAX">
<span class="sig-name descname"><span class="pre">MAX</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#fairseq2.gang.ReduceOperation.MAX" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="factory-functions">
<h2>Factory Functions<a class="headerlink" href="#factory-functions" title="Link to this heading">¶</a></h2>
<p>See the <a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.create_default_process_group" title="fairseq2.gang.ProcessGroupGang.create_default_process_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ProcessGroupGang.create_default_process_group()</span></code></a> method for
creating the default PyTorch ProcessGroup. The rest of the factory functions
listed below are used to create sub-gangs for different parallelism strategies.</p>
<dl class="py function">
<dt class="sig sig-object py" id="fairseq2.gang.create_parallel_gangs">
<span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">create_parallel_gangs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_gang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><span class="pre">Gangs</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#create_parallel_gangs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.create_parallel_gangs" title="Link to this definition">¶</a></dt>
<dd><p>Creates gangs to be used for data and model parallelism.</p>
<p>For instance, if there are 8 devices denoted by d0 to d7 and 2 devices are
used for tensor parallelism (i.e. <code class="docutils literal notranslate"><span class="pre">tp_size</span></code> is 2), this function will
create 4 tensor parallel gangs and 2 data parallel gangs by splitting
<code class="docutils literal notranslate"><span class="pre">root_gang</span></code> as:</p>
<dl class="simple">
<dt>4 tensor parallel gangs:</dt><dd><p>[d0, d1], [d2, d3], [d4, d5], [d6, d7]</p>
</dd>
<dt>2 data parallel gangs:</dt><dd><p>[d0, d2, d4, d6], [d1, d3, d5, d7]</p>
</dd>
</dl>
<p>For efficiency, the caller should make sure adjacent ranks are on the same
host. For example, if there are two hosts with a total of 16 GPUs, ranks 0
to 7 belong to the first host and ranks 8 to 15 belong to the second host.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">root_gang</span></code> is a PyTorch <code class="docutils literal notranslate"><span class="pre">ProcessGroup</span></code> with NCCL backend, this
function uses the experimental <code class="docutils literal notranslate"><span class="pre">split_group</span></code> API in PyTorch 2.5 and
later. See <a class="reference external" href="https://dev-discuss.pytorch.org/t/rfc-c10d-a-new-pytorch-api-split-group-to-create-a-process-group-through-ncclcommsplit/2233">here</a> for more information.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fairseq2.gang.create_fsdp_gangs">
<span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">create_fsdp_gangs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gangs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><span class="pre">Gangs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">intra_node_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><span class="pre">Gangs</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#create_fsdp_gangs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.create_fsdp_gangs" title="Link to this definition">¶</a></dt>
<dd><p>Creates gangs to be used for hybrid or fully sharded data parallelism.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">intra_node_size</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <a class="reference internal" href="#fairseq2.gang.Gangs.sdp" title="fairseq2.gang.Gangs.sdp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gangs.sdp</span></code></a> (sharded data gang)
will be set to the same gang as <a class="reference internal" href="#fairseq2.gang.Gangs.dp" title="fairseq2.gang.Gangs.dp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gangs.dp</span></code></a> and <a class="reference internal" href="#fairseq2.gang.Gangs.rdp" title="fairseq2.gang.Gangs.rdp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gangs.rdp</span></code></a>
(replicated data gang) will be set to a fake gang of size 1. This topology
represents a fully sharded data parallel strategy.</p>
<p>An integer <code class="docutils literal notranslate"><span class="pre">intra_node_size</span></code> indicates hybrid sharded data parallelism.
For instance, if there are 8 devices denoted by d0 to d7 and 4 devices are
used for intra-node parallelism (i.e. <code class="docutils literal notranslate"><span class="pre">intra_node_size</span></code> is 4), this
function will create 2 intra-node gangs and 4 inter-node gangs by splitting
<code class="docutils literal notranslate"><span class="pre">gangs.dp</span></code> as:</p>
<dl class="simple">
<dt>2 intra-node gangs of size 4:</dt><dd><p>[d0, d1, d2, d3], [d4, d5, d6, d7]</p>
</dd>
<dt>4 inter-node gangs of size 2:</dt><dd><p>[d0, d4], [d1, d5], [d2, d6], [d3, d7]</p>
</dd>
</dl>
<p>For efficiency, the caller should make sure adjacent ranks are on the same
host.</p>
<p>At the end of the call, <code class="docutils literal notranslate"><span class="pre">gangs.rdp</span></code> (replicated data gang) will point to
the inter-node gang and <code class="docutils literal notranslate"><span class="pre">gangs.sdp</span></code> (sharded data gang) will point to the
intra-node gang.</p>
<p>Returns the same <a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gangs</span></code></a> instance passed to <code class="docutils literal notranslate"><span class="pre">gangs</span></code> with its
<a class="reference internal" href="#fairseq2.gang.Gangs.rdp" title="fairseq2.gang.Gangs.rdp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gangs.rdp</span></code></a> and <a class="reference internal" href="#fairseq2.gang.Gangs.sdp" title="fairseq2.gang.Gangs.sdp"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gangs.sdp</span></code></a> attributes set accordingly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">root_gang</span></code> is a PyTorch <code class="docutils literal notranslate"><span class="pre">ProcessGroup</span></code> with NCCL backend, this
function uses the experimental <code class="docutils literal notranslate"><span class="pre">split_group</span></code> API in PyTorch 2.5 and
later. See <a class="reference external" href="https://dev-discuss.pytorch.org/t/rfc-c10d-a-new-pytorch-api-split-group-to-create-a-process-group-through-ncclcommsplit/2233">here</a> for more information.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fairseq2.gang.create_fake_gangs">
<span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">create_fake_gangs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.8)"><span class="pre">device</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><span class="pre">Gangs</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#create_fake_gangs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.create_fake_gangs" title="Link to this definition">¶</a></dt>
<dd><p>Creates a set of fake gangs for single-process scenarios.</p>
<p>This is a helper function where every <a class="reference internal" href="#fairseq2.gang.FakeGang" title="fairseq2.gang.FakeGang"><code class="xref py py-class docutils literal notranslate"><span class="pre">FakeGang</span></code></a> is initialized with
rank 0 and world size 1. For more complex simulated/testing environments,
<a class="reference internal" href="#fairseq2.gang.FakeGang" title="fairseq2.gang.FakeGang"><code class="xref py py-class docutils literal notranslate"><span class="pre">FakeGang</span></code></a> instances can be individually constructed per parallelism
strategy and passed to a <a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gangs</span></code></a> object.</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">Creating fake gangs for testing</span><a class="headerlink" href="#id13" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">fairseq2.gang</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_fake_gangs</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="n">gangs</span> <span class="o">=</span> <span class="n">create_fake_gangs</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">gang</span><span class="o">.</span><span class="n">rank</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Simulates as if a real all-reduce operation is performed on the data</span>
<span class="c1"># parallel gang.</span>
<span class="n">gangs</span><span class="o">.</span><span class="n">dp</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">ReduceOperation</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<section id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fairseq2.gang.maybe_get_current_gangs">
<span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">maybe_get_current_gangs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><span class="pre">Gangs</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#maybe_get_current_gangs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.maybe_get_current_gangs" title="Link to this definition">¶</a></dt>
<dd><p>Returns the current gangs to use for collective operations.</p>
<p>By default, this function returns <code class="docutils literal notranslate"><span class="pre">None</span></code>. The current gangs of the calling
thread can be set by using <a class="reference internal" href="#fairseq2.gang.Gangs" title="fairseq2.gang.Gangs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gangs</span></code></a> as a context manager:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fairseq2.gang</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gangs</span>

<span class="n">gangs</span> <span class="o">=</span> <span class="n">Gangs</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="k">with</span> <span class="n">gangs</span><span class="p">:</span>
    <span class="n">current_gangs</span> <span class="o">=</span> <span class="n">maybe_get_current_gangs</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">current_gangs</span> <span class="ow">is</span> <span class="n">gangs</span>

<span class="n">current_gangs</span> <span class="o">=</span> <span class="n">maybe_get_current_gangs</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">current_gangs</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
<p>Within fairseq2, this function is used by model factories to retrieve the
current gangs and shard the constructed models accordingly. The current gangs
are set internally by fairseq2 before calling the factories.</p>
<p>Note that the return value of this function is thread specific. Individual
threads may have their own set of current gangs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fairseq2.gang.broadcast_flag">
<span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">broadcast_flag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#broadcast_flag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.broadcast_flag" title="Link to this definition">¶</a></dt>
<dd><p>Broadcasts a boolean flag to all processes in <code class="docutils literal notranslate"><span class="pre">gang</span></code> from the specified
rank.</p>
<p>Returns the broadcasted boolean value on all processes.</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">Broadcasting a flag across processes</span><a class="headerlink" href="#id14" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Only rank 0 sets the flag</span>
<span class="n">should_continue</span> <span class="o">=</span> <span class="n">gang</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">some_condition</span><span class="p">()</span>

<span class="c1"># Broadcast the decision to all processes</span>
<span class="n">should_continue</span> <span class="o">=</span> <span class="n">broadcast_flag</span><span class="p">(</span><span class="n">gang</span><span class="p">,</span> <span class="n">should_continue</span><span class="p">,</span> <span class="n">source_rank</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">should_continue</span><span class="p">:</span>
    <span class="c1"># All processes execute this together</span>
    <span class="n">continue_processing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fairseq2.gang.all_sum">
<span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">all_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.Gang" title="fairseq2.gang.Gang"><span class="pre">Gang</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#all_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.all_sum" title="Link to this definition">¶</a></dt>
<dd><p>Sums a scalar value over all processes in <code class="docutils literal notranslate"><span class="pre">gang</span></code>.</p>
<p>Returns a tensor containing the sum of all process values.</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">Computing total loss across processes</span><a class="headerlink" href="#id15" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Each process computes its local loss</span>
<span class="n">local_loss</span> <span class="o">=</span> <span class="n">compute_loss</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1"># Sum losses across all processes</span>
<span class="n">total_loss</span> <span class="o">=</span> <span class="n">all_sum</span><span class="p">(</span><span class="n">gang</span><span class="p">,</span> <span class="n">local_loss</span><span class="p">)</span>

<span class="c1"># Now `total_loss` contains the sum from all processes</span>
<span class="n">average_loss</span> <span class="o">=</span> <span class="n">total_loss</span> <span class="o">/</span> <span class="n">gang</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fairseq2.gang.GangError">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">GangError</span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#GangError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.GangError" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Raised when a collective communication error occurs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fairseq2.gang.raise_operational_gang_error">
<span class="sig-prename descclassname"><span class="pre">fairseq2.gang.</span></span><span class="sig-name descname"><span class="pre">raise_operational_gang_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cause</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fairseq2.gang.GangError" title="fairseq2.gang.GangError"><span class="pre">GangError</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NoReturn" title="(in Python v3.14)"><span class="pre">NoReturn</span></a></span></span><a class="reference internal" href="../_modules/fairseq2/gang.html#raise_operational_gang_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fairseq2.gang.raise_operational_gang_error" title="Link to this definition">¶</a></dt>
<dd><p>Raises an <code class="xref py py-class docutils literal notranslate"><span class="pre">OperationalError</span></code> caused by a collective communication error.</p>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="fairseq2.model_checkpoint.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">fairseq2.model_checkpoint</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="fairseq2.device.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">fairseq2.device</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/facebookresearch/fairseq2" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">fairseq2.gang</a><ul>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#fairseq2.gang.Gang"><code class="docutils literal notranslate"><span class="pre">Gang</span></code></a><ul>
<li><a class="reference internal" href="#fairseq2.gang.Gang.create_gang"><code class="docutils literal notranslate"><span class="pre">Gang.create_gang()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.as_process_group"><code class="docutils literal notranslate"><span class="pre">Gang.as_process_group()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.barrier"><code class="docutils literal notranslate"><span class="pre">Gang.barrier()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.all_reduce"><code class="docutils literal notranslate"><span class="pre">Gang.all_reduce()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.all_gather"><code class="docutils literal notranslate"><span class="pre">Gang.all_gather()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.all_gather_to_list"><code class="docutils literal notranslate"><span class="pre">Gang.all_gather_to_list()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.broadcast"><code class="docutils literal notranslate"><span class="pre">Gang.broadcast()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.broadcast_objects"><code class="docutils literal notranslate"><span class="pre">Gang.broadcast_objects()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.rank"><code class="docutils literal notranslate"><span class="pre">Gang.rank</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.size"><code class="docutils literal notranslate"><span class="pre">Gang.size</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.device"><code class="docutils literal notranslate"><span class="pre">Gang.device</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gang.supports_process_group"><code class="docutils literal notranslate"><span class="pre">Gang.supports_process_group</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang</span></code></a><ul>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.create_default_process_group"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.create_default_process_group()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.close"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.close()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.create_gang"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.create_gang()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.as_process_group"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.as_process_group()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.barrier"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.barrier()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.all_reduce"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.all_reduce()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.all_gather"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.all_gather()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.all_gather_to_list"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.all_gather_to_list()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.broadcast"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.broadcast()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.broadcast_objects"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.broadcast_objects()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.rank"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.rank</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.size"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.size</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.device"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.device</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ProcessGroupGang.supports_process_group"><code class="docutils literal notranslate"><span class="pre">ProcessGroupGang.supports_process_group</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang"><code class="docutils literal notranslate"><span class="pre">FakeGang</span></code></a><ul>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.close"><code class="docutils literal notranslate"><span class="pre">FakeGang.close()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.create_gang"><code class="docutils literal notranslate"><span class="pre">FakeGang.create_gang()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.as_process_group"><code class="docutils literal notranslate"><span class="pre">FakeGang.as_process_group()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.barrier"><code class="docutils literal notranslate"><span class="pre">FakeGang.barrier()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.all_reduce"><code class="docutils literal notranslate"><span class="pre">FakeGang.all_reduce()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.all_gather"><code class="docutils literal notranslate"><span class="pre">FakeGang.all_gather()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.all_gather_to_list"><code class="docutils literal notranslate"><span class="pre">FakeGang.all_gather_to_list()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.broadcast"><code class="docutils literal notranslate"><span class="pre">FakeGang.broadcast()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.broadcast_objects"><code class="docutils literal notranslate"><span class="pre">FakeGang.broadcast_objects()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.rank"><code class="docutils literal notranslate"><span class="pre">FakeGang.rank</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.size"><code class="docutils literal notranslate"><span class="pre">FakeGang.size</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.device"><code class="docutils literal notranslate"><span class="pre">FakeGang.device</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.FakeGang.supports_process_group"><code class="docutils literal notranslate"><span class="pre">FakeGang.supports_process_group</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fairseq2.gang.Gangs"><code class="docutils literal notranslate"><span class="pre">Gangs</span></code></a><ul>
<li><a class="reference internal" href="#fairseq2.gang.Gangs.root"><code class="docutils literal notranslate"><span class="pre">Gangs.root</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gangs.dp"><code class="docutils literal notranslate"><span class="pre">Gangs.dp</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gangs.rdp"><code class="docutils literal notranslate"><span class="pre">Gangs.rdp</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gangs.sdp"><code class="docutils literal notranslate"><span class="pre">Gangs.sdp</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gangs.tp"><code class="docutils literal notranslate"><span class="pre">Gangs.tp</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gangs.pp"><code class="docutils literal notranslate"><span class="pre">Gangs.pp</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.Gangs.close"><code class="docutils literal notranslate"><span class="pre">Gangs.close()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#enums">Enums</a><ul>
<li><a class="reference internal" href="#fairseq2.gang.ReduceOperation"><code class="docutils literal notranslate"><span class="pre">ReduceOperation</span></code></a><ul>
<li><a class="reference internal" href="#fairseq2.gang.ReduceOperation.SUM"><code class="docutils literal notranslate"><span class="pre">ReduceOperation.SUM</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ReduceOperation.MEAN"><code class="docutils literal notranslate"><span class="pre">ReduceOperation.MEAN</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ReduceOperation.PRODUCT"><code class="docutils literal notranslate"><span class="pre">ReduceOperation.PRODUCT</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ReduceOperation.MIN"><code class="docutils literal notranslate"><span class="pre">ReduceOperation.MIN</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.ReduceOperation.MAX"><code class="docutils literal notranslate"><span class="pre">ReduceOperation.MAX</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#factory-functions">Factory Functions</a><ul>
<li><a class="reference internal" href="#fairseq2.gang.create_parallel_gangs"><code class="docutils literal notranslate"><span class="pre">create_parallel_gangs()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.create_fsdp_gangs"><code class="docutils literal notranslate"><span class="pre">create_fsdp_gangs()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.create_fake_gangs"><code class="docutils literal notranslate"><span class="pre">create_fake_gangs()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#utilities">Utilities</a><ul>
<li><a class="reference internal" href="#fairseq2.gang.maybe_get_current_gangs"><code class="docutils literal notranslate"><span class="pre">maybe_get_current_gangs()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.broadcast_flag"><code class="docutils literal notranslate"><span class="pre">broadcast_flag()</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.all_sum"><code class="docutils literal notranslate"><span class="pre">all_sum()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#exceptions">Exceptions</a><ul>
<li><a class="reference internal" href="#fairseq2.gang.GangError"><code class="docutils literal notranslate"><span class="pre">GangError</span></code></a></li>
<li><a class="reference internal" href="#fairseq2.gang.raise_operational_gang_error"><code class="docutils literal notranslate"><span class="pre">raise_operational_gang_error()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=ec806d2c"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>